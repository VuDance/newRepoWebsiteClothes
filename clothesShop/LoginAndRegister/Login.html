<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./Login.css" />
    <title>Document</title>
  </head>
  <body>
    <form class="form">
      <p class="form-title">Sign in to your account</p>
      <div class="input-container">
        <input id="email" placeholder="Enter email" type="email" />
        <span>
          <svg
            stroke="currentColor"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"
              stroke-width="2"
              stroke-linejoin="round"
              stroke-linecap="round"
            ></path>
          </svg>
        </span>
      </div>
      <div class="input-container">
        <input id="password" placeholder="Enter password" type="password" />

        <span>
          <svg
            stroke="currentColor"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
              stroke-width="2"
              stroke-linejoin="round"
              stroke-linecap="round"
            ></path>
            <path
              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
              stroke-width="2"
              stroke-linejoin="round"
              stroke-linecap="round"
            ></path>
          </svg>
        </span>
      </div>
      <div style="color: red; display: none" id="notifi">
        Sai tài khoản hoặc mật khẩu
      </div>
      <button class="submit" type="submit" id="btnLogin">Sign in</button>

      <p class="signup-link">
        No account?
        <a href="./Register.html">Sign up</a>
      </p>
    </form>
    <script type="module">
      import list from "./ListUser.js";
      function login() {
        var email = document.getElementById("email").value;
        var password = document.getElementById("password").value;
        if (email === "") {
          alert("Vui lòng nhập địa chỉ email.");
          return false;
        }
        console.log("ol");
        var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          alert("Vui lòng nhập địa chỉ email hợp lệ.");
          return false;
        }

        if (password === "") {
          alert("Vui lòng nhập mật khẩu.");
          return false;
        }

        let exitUser = list.filter((i) => i.email === email);
        if (exitUser.length === 0) {
          document.getElementById("notifi").classList.add("show");
        } else {
          if (exitUser[0].password === password) {
            localStorage.setItem("user", JSON.stringify(exitUser[0]));
            window.location.href = "../Home/Home.html";
          } else {
            document.getElementById("notifi").classList.add("show");
          }
        }
      }
      document
        .getElementById("btnLogin")
        .addEventListener("click", function (e) {
          e.preventDefault();
          login();
        });
    </script>
  </body>
</html>
